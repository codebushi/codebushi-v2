

<!DOCTYPE html>



<html amp lang="en-us" class="no-js">
<head>
    <title>An Introduction To Using Gatsby Image</title>
    <meta charset="utf-8">

    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>

    <script async src="https://cdn.ampproject.org/v0.js"></script>

    
        

<link rel="amp-manifest" href="/amp-manifest.json">

    




    <link rel="canonical" href="https://codebushi.com/using-gatsby-image/">
    <link rel="icon" type="image/x-icon" href="https://codebushi.com/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <meta name="description" content="Gatsby-image is a React component that works with Gatsby.js to give you an easy way to load and optimize images on a website.">

    

    <meta name="theme-color" content="#f72060" />

    
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Code Bushi",
    "alternateName": "Code Bushi",
    "url": "https://codebushi.com/"
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "codebushi.com",
  "url": "https://codebushi.com/"
  
  , "logo": "https://codebushi.com/codebushilogo.png"
  
  
}
</script>
















<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https://codebushi.com/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 2,
        "item": {
          "@id": "https://codebushi.com/using-gatsby-image/",
          "name": "using-gatsby-image"
        }
    }]
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Hunter Chang"
  },
  "headline": "An Introduction To Using Gatsby Image",
  "description": "Gatsby-image is a React component that works with Gatsby.js to give you an easy way to load and optimize images on a website.",
  "wordCount": 1032,
  "datePublished" : "2017-11-19",
  "dateModified" : "2017-11-19",
  "image" : {
      "@context": "http://schema.org",
      "@type": "ImageObject",
      "url": "https://codebushi.com/amp/img/gatsby-image.jpg",
      "height" : 503,
      "width" : 920
    },
  "mainEntityOfPage" : "https://codebushi.com/using-gatsby-image/",
  "publisher" : {
    "@type": "Organization",
    "name" : "codebushi.com",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https://codebushi.com/codebushilogoamp.png",
        "height" : 60,
        "width" : 320
    }
  }
}
</script>




    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>
        html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{margin:.67em 0}mark{background:#ff0;color:#000}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}td,th{padding:0}*{box-sizing:border-box}button,input,select,textarea{font:13px/1.4 Helvetica,arial,freesans,clean,sans-serif}a{color:#4183c4}a:active,a:focus,a:hover{text-decoration:underline}.rule,hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border:0;border-bottom:1px solid #ddd}.rule:after,.rule:before,hr:after,hr:before{display:table;content:""}.rule:after,hr:after{clear:both}fieldset{padding:0;margin:0;border:0}label{font-size:13px;font-weight:700}#adv_code_search .search-page-label,input[type=email],input[type=number],input[type=password],input[type=tel],input[type=text],input[type=url],textarea{min-height:34px;padding:7px 8px;font-size:13px;color:#333;vertical-align:middle;background-color:#fff;background-repeat:no-repeat;background-position:100%;border:1px solid #ccc;border-radius:3px;outline:none;box-shadow:inset 0 1px 2px rgba(0,0,0,.075)}#adv_code_search .focus.search-page-label,#adv_code_search .search-page-label:focus,.focused .drag-and-drop,input[type=email].focus,input[type=email]:focus,input[type=number].focus,input[type=number]:focus,input[type=password].focus,input[type=password]:focus,input[type=tel].focus,input[type=tel]:focus,input[type=text].focus,input[type=text]:focus,input[type=url].focus,input[type=url]:focus,textarea.focus,textarea:focus{border-color:#51a7e8;box-shadow:inset 0 1px 2px rgba(0,0,0,.075),0 0 5px rgba(81,167,232,.5)}.input-contrast,input.input-contrast{background-color:#fafafa}.input-contrast:focus,input.input-contrast:focus{background-color:#fff}:-moz-placeholder,::-webkit-input-placeholder{color:#aaa}::-webkit-validation-bubble-message{font-size:12px;color:#fff;background:#9c2400;border:0;border-radius:3px;-webkit-box-shadow:1px 1px 1px rgba(0,0,0,.1)}input::-webkit-validation-bubble-icon{display:none}::-webkit-validation-bubble-arrow{background-color:#9c2400;border:1px solid #9c2400;-webkit-box-shadow:1px 1px 1px rgba(0,0,0,.1)}.absent{color:#c00}.anchor{position:absolute;top:0;bottom:0;left:0;display:block;padding-right:6px;padding-left:30px;margin-left:-30px}.anchor:focus{outline:none}h1,h2,h3,h4,h5,h6{position:relative;margin-top:1em;margin-bottom:16px;font-weight:700;line-height:1.4}h1 .octicon-link,h2 .octicon-link,h3 .octicon-link,h4 .octicon-link,h5 .octicon-link,h6 .octicon-link{display:none;color:#000;vertical-align:middle}h1:hover .anchor,h2:hover .anchor,h3:hover .anchor,h4:hover .anchor,h5:hover .anchor,h6:hover .anchor{height:1em;padding-left:8px;margin-left:-30px;line-height:1;text-decoration:none}h1:hover .anchor .octicon-link,h2:hover .anchor .octicon-link,h3:hover .anchor .octicon-link,h4:hover .anchor .octicon-link,h5:hover .anchor .octicon-link,h6:hover .anchor .octicon-link{display:inline-block}h1 code,h1 tt,h2 code,h2 tt,h3 code,h3 tt,h4 code,h4 tt,h5 code,h5 tt,h6 code,h6 tt{font-size:inherit}h1{font-size:2.25em;line-height:1.2}h1,h2{padding-bottom:.3em;border-bottom:1px solid #eee}h2{font-size:1.75em;line-height:1.225}h3{font-size:1.5em;line-height:1.43}h4{font-size:1.25em}h5,h6{font-size:1em}h6{color:#777}blockquote,dl,ol,p,pre,table,ul{margin-top:0;margin-bottom:16px}hr{height:4px;margin:16px 0;background-color:#e7e7e7;border:0 none}ol,ul{padding-left:2em}ol.no-list,ul.no-list{padding:0;list-style-type:none}ol ol,ol ul,ul ol,ul ul{margin-top:0;margin-bottom:0}li>p{margin-top:16px}dl,dl dt{padding:0}dl dt{margin-top:16px;font-size:1em;font-style:italic;font-weight:700}dl dd{padding:0 16px;margin-bottom:16px}blockquote{padding:0 15px;color:#777;border-left:4px solid #ddd}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}table th{font-weight:700}table td,table th{padding:6px 13px;border:1px solid #ddd}table tr{background-color:#fff;border-top:1px solid #ccc}table tr:nth-child(2n){background-color:#f8f8f8}img{max-width:100%;box-sizing:border-box}span.frame,span.frame>span{display:block;overflow:hidden}span.frame>span{float:left;width:auto;padding:7px;margin:13px 0 0;border:1px solid #ddd}span.frame span img{display:block;float:left}span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}span.align-center{display:block;overflow:hidden;clear:both}span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}span.align-center span img{margin:0 auto;text-align:center}span.align-right{display:block;overflow:hidden;clear:both}span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}span.align-right span img{margin:0;text-align:right}span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}span.float-left span{margin:13px 0 0}span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}code,tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:"\00a0"}code br,tt br{display:none}del code{text-decoration:inherit;vertical-align:text-top}pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.highlight{margin-bottom:16px}.highlight pre,pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.highlight pre{margin-bottom:0;word-break:normal}pre,pre code,pre tt{word-wrap:normal}pre code,pre tt{display:inline;max-width:none;padding:0;margin:0;overflow:initial;line-height:inherit;background-color:transparent;border:0}pre code:after,pre code:before,pre tt:after,pre tt:before{content:normal}abbr,address,article,aside,audio,b,blockquote,body,canvas,caption,cite,code,dd,del,details,dfn,div,dl,dt,em,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,p,pre,q,samp,section,small,span,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,ul,var,video{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}nav ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}a{margin:0;padding:0;font-size:100%;vertical-align:baseline;background:transparent}ins{text-decoration:none}ins,mark{background-color:#ff9;color:#000}mark{font-style:italic;font-weight:700}del{text-decoration:line-through}abbr[title],dfn[title]{border-bottom:1px dotted;cursor:help}table{border-collapse:collapse;border-spacing:0}hr{display:block;height:1px;border-top:1px solid #ccc;margin:1em 0}input,select{vertical-align:middle}body{background-color:#0f1621;color:#fff;font-size:14px;font-family:Helvetica Neue,Helvetica,Segoe UI,Arial,freesans,sans-serif}main{max-width:1180px;padding:30px;margin:0 auto}h1{font-weight:300;line-height:1.4em;margin:.5em 0;font-family:Georgia,serif;transition:color .4s}h1,h2{font-size:2em}h2,h3{font-weight:300;margin:30px 0}h3{font-size:1.8em}h4{font-size:1.6em}h4,h5{font-weight:300}h5{font-size:1.2em}h6{font-weight:300;font-size:1em}p{line-height:1.4em;font-size:1.2em;margin:15px 0}blockquote{border-left:5px solid #ff1d55;background-color:#ffe9ee;padding:1em;margin-bottom:1em}small{font-size:80%}.lightbox{background-color:rgba(3,121,196,.4);min-height:100vh;min-width:100vw;padding:30px}code{font:14px Consolas,Liberation Mono,Menlo,Courier,monospace}p>code{color:#ff1d55}pre code{display:block;background-color:#f7f7f7;padding:15px;overflow:auto;color:#123;line-height:1.4em}a{color:#f72060;text-decoration:none;transition:color .4s,background .4s}a:hover{color:#e9003a}ol,ul{margin:7.5px;padding:7.5px 15px}ol li,ul li{margin:7.5px 15px}.doc-parameters{list-style-type:none;padding:0}.doc-parameters li{display:block;margin:0;margin-bottom:15px}.doc-parameters .example,.doc-parameters blockquote{border-left:5px solid #0379c4;background-color:#96d5fd;color:#123;line-height:1em;font-size:1em;padding:1em;margin:0}.doc-parameters .example{background-color:#c8e9fe}.doc-parameters .parameter{display:block;padding:1em;background-color:#0379c4;color:#fff;margin:0}.doc-parameters .parameter strong{display:inline-block;padding:0 .5em;border-radius:.25em;line-height:2em;background-color:#025a92}hr{height:.25em;padding:0;margin:24px 0;background-color:#f7f7f7;border:0}.teaser{display:-ms-flexbox;display:flex;text-align:left;-ms-flex-line-pack:center;align-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between}.teaser aside{-ms-flex-preferred-size:60%;flex-basis:60%;-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;padding:30px}@media (max-width:700px){.teaser aside{-ms-flex-preferred-size:100%;flex-basis:100%}}.teaser .content{-ms-flex-preferred-size:40%;flex-basis:40%;-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;color:dimgray;font-size:12px}@media (max-width:700px){.teaser .content{-ms-flex-preferred-size:100%;flex-basis:100%}}.teaser .content.content-full{-ms-flex-preferred-size:100%;flex-basis:100%}.teaser .content h3{font-size:14px;text-transform:uppercase;font-weight:600;color:#123}.main-index{text-align:center}.main-index amp-img{margin:15px auto;width:50%}@media (min-width:900px){h1{font-size:3em}.main-index p{font-size:2em}}.breadcrumbs{padding:1em;background-color:#f7f7f7}.breadcrumbs ul{display:block;margin:0;padding:0}.breadcrumbs ul li{display:inline-block;margin:0 .5em}.breadcrumbs ul li:before{content:" / ";position:relative;margin-left:-.5em;color:dimgray}.breadcrumbs ul li a{color:dimgray}.breadcrumbs ul li:last-child a{color:#ff1d55}header{background-color:#ff1d55;color:#fff;padding:30px;position:relative}header .brand{display:inline-block;position:absolute;left:30px;top:20px;line-height:15px;text-transform:uppercase;padding:7.5px;font-size:1.4em}header .brand:hover{background-color:#ff1d55;color:#fff}header a{color:#fff;text-decoration:none;border-radius:7.5px;padding:7.5px}header a:hover{text-decoration:none;background-color:#fff;color:#ff1d55}header nav ul{padding:0;margin:0;display:block;text-align:right}header nav ul li{padding:0;margin:0 7.5px;display:inline-block}header nav ul li.hamburger{display:none}header nav ul li.hamburger button{position:absolute;right:30px;top:20px;border:0;background-color:#fff;color:#ff1d55;font-weight:700;border-radius:50%;width:30px;height:30px;overflow:hidden;text-align:center;padding:0;margin:0}@media (max-width:900px){header nav ul li{display:none}header nav ul li.hamburger{display:inline-block}}.sidebarNavigation{width:210px;max-width:95%}.sidebarNavigation ul{padding:0;margin:0}.sidebarNavigation ul li{display:block}.sidebarNavigation ul li a{display:block;line-height:1.4em;padding:7.5px}footer{margin:60px auto;display:-ms-flexbox;display:flex;-ms-flex-line-pack:center;align-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between;max-width:1180px;padding:30px;font-size:12px}footer a:hover{text-decoration:none}footer strong{text-transform:uppercase;margin-bottom:15px;display:block}footer strong a{color:#1d1d1d}footer ul{display:block;padding:0;margin:0}footer ul li{display:block;line-height:1.4em;padding:7.5px 0;margin:0}footer ul li a{color:dimgray}footer .quarter-section{margin-bottom:30px;-ms-flex-preferred-size:25%;flex-basis:25%}@media (max-width:900px){footer .quarter-section{-ms-flex-preferred-size:33%;flex-basis:33%}}@media (max-width:700px){footer .quarter-section{-ms-flex-preferred-size:50%;flex-basis:50%}}@media (max-width:500px){footer .quarter-section{-ms-flex-preferred-size:100%;flex-basis:100%}}.boxes{display:-ms-flexbox;display:flex;-ms-flex-line-pack:center;align-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between;font-size:12px}.boxes .box{-ms-flex-preferred-size:30%;flex-basis:30%;background-color:#f7f7f7;padding:30px;margin:7.5px 0;text-align:left;font-size:12px}.boxes .box h3{font-size:12px;line-height:1em;padding:0;margin:0}.boxes .box a{padding:0;color:#ff1d55}.boxes .box p{color:dimgray;font-size:12px;margin:7.5px 0}@media (max-width:900px){.boxes .box{-ms-flex-preferred-size:45%;flex-basis:45%}}@media (max-width:500px){.boxes .box{-ms-flex-preferred-size:100%;flex-basis:100%}}.mt-5,.my-5{margin-top:3rem}.mt-4,.my-4{margin-top:1.5rem}.mb-5,.my-5{margin-bottom:3rem}.mb-4,.my-4{margin-bottom:1.5rem}
    </style>


</head>

<body>






<main>
    <h1>An Introduction To Using Gatsby Image</h1>
    <div>
        <p><small>November 19, 2017</small></p>
    </div>
    <div>
        <p><amp-img src="https://codebushi.com/amp/img/gatsby-image.jpg" alt="" layout="responsive" width="920" height="503"></amp-img></p>
    </div>
    <div>
        <p>With the rise of mobile browsing, the optimization of images on a website is more important than ever. If a site is image heavy, it&rsquo;s always a good idea to lazy load images that are further down the page to speed up the initial render. However, optimizing and implementing lazy loading images can be pretty time consuming. <a href="https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-image">Gatsby-image</a> is a React component that works with Gatsby.js to give you an easy way to load and optimize images on a website.</p>

<p>If you haven&rsquo;t already, go through the official <a href="https://www.gatsbyjs.org/tutorial/">Gatsby.js tutorial</a> first, you&rsquo;ll need to know some of the basics of Gatsby and GraphQL before we get started. Here is a demo of what we&rsquo;ll be building:</p>

<h4 class="mt-4 mb-4"><a href="http://hc-gatsby-image-demo.surge.sh/">Gatsby Image Demo</a> <small>( <a href="https://github.com/ChangoMan/gatsby-image-demo">view source</a> )</small></h4>

<p>Let&rsquo;s start off by installing and running the <a href="https://github.com/gatsbyjs/gatsby-starter-blog">gatsby-starter-blog</a>:</p>

<pre><code class="language-bash">gatsby new gatsby-image-demo https://github.com/gatsbyjs/gatsby-starter-blog
cd gatsby-image-demo
gatsby develop
</code></pre>

<p>Go to <code>http://localhost:8000/</code> and you&rsquo;ll see something <a href="http://gatsbyjs.github.io/gatsby-starter-blog/">like this</a>. We can now add some images to this starter blog!</p>

<p>Let&rsquo;s make a new directory for our cool new images. From the root folder of the project:</p>

<pre><code class="language-bash">cd src/
mkdir images
</code></pre>

<p>One of my go-to websites for free stock images is <a href="https://unsplash.com/">https://unsplash.com/</a>. Just download a few images and save them into the new <code>src/images</code> folder. I&rsquo;m going to save them as one.jpg, two.jpg, and three.jpg for ease of reference.</p>

<p>Going back to the terminal, let&rsquo;s stop the <code>gatsby develop</code> and add the <code>gatsby-image</code> package:</p>

<pre><code class="language-bash">yarn add gatsby-image
</code></pre>

<p>If you didn&rsquo;t use the gatsby-starter-blog mentioned above, you may need to include <code>gatsby-transformer-sharp</code> and <code>gatsby-plugin-sharp</code> as well, and make sure they are installed and included in your gatsby-config.</p>

<h3 class="mt-5 mb-3">Adding your images folder to gatsby-config.js</h3>

<p>Now open up <code>gatsby-config.js</code>. Since <code>gatsby-image</code> is a React component, we don&rsquo;t need to add it to the config file. However, we do need to set up our <code>src/images</code> folder using <code>gatsby-source-filesystem</code> so we can use GraphQL to query our images. Look for this object in the config file, in the plugins array:</p>

<pre><code class="language-javascript">{
  resolve: `gatsby-source-filesystem`,
  options: {
    path: `${__dirname}/src/pages`,
    name: 'pages',
  },
},
</code></pre>

<p>This is telling Gatsby to look in the <code>/src/pages</code> directory for some files, and make &ldquo;nodes&rdquo; out of them. These nodes are needed when making the GraphQL queries for the site. This <code>/src/pages</code> directory is where all the current pages and posts are kept. We will add our images directory right under this object and change the <code>path</code> and <code>name</code> options. Your <code>gatsby-config.js</code> should now have this:</p>

<pre><code class="language-javascript">{
  resolve: `gatsby-source-filesystem`,
  options: {
    path: `${__dirname}/src/pages`,
    name: 'pages',
  },
},
{
  resolve: `gatsby-source-filesystem`,
  options: {
    path: `${__dirname}/src/images`,
    name: 'images',
  },
},
...
</code></pre>

<h3 class="mt-5 mb-3">Back into Gatsby</h3>

<p>Let&rsquo;s start up Gatsby again by running <code>gatsby develop</code>. The site should look the same as before, but now we can query our new stock images. Open up <code>/src/pages/index.js</code> which is the component for the homepage. Scroll to the bottom and you&rsquo;ll see the GraphQL query that&rsquo;s currently being used:</p>

<pre><code class="language-javascript">export const pageQuery = graphql`
  query IndexQuery {
    site {
      siteMetadata {
        title
      }
    }
    allMarkdownRemark(sort: { fields: [frontmatter___date], order: DESC }) {
      edges {
        node {
          excerpt
          fields {
            slug
          }
          frontmatter {
            date(formatString: &quot;DD MMMM, YYYY&quot;)
            title
          }
        }
      }
    }
  }
`
</code></pre>

<p>This query is currently getting the site&rsquo;s title from the <code>siteMetadata</code>, as well as all the posts from <code>allMarkdownRemark</code>. We&rsquo;ll need to add a query right below <code>allMarkdownRemark</code> for our image <code>one.jpg</code>. The query now looks like this:</p>

<pre><code class="language-javascript">export const pageQuery = graphql`
  query IndexQuery {
    site {
      siteMetadata {
        title
      }
    }
    allMarkdownRemark(sort: { fields: [frontmatter___date], order: DESC }) {
      edges {
        node {
          excerpt
          fields {
            slug
          }
          frontmatter {
            date(formatString: &quot;DD MMMM, YYYY&quot;)
            title
          }
        }
      }
    }
    imageOne: imageSharp(id: { regex: &quot;/one.jpg/&quot; }) {
      sizes(maxWidth: 630) {
        ...GatsbyImageSharpSizes
      }
    }
  }
`
</code></pre>

<p><code>imageOne</code> will be a new object that&rsquo;s added to <code>this.props.data</code>. Since we are going to put this in the main container of the page, and it will be fluid on mobile, I&rsquo;m querying for the child object called <code>sizes</code> with a maxWidth of the container size, which is 630px. There&rsquo;s another image type you can query for, called <code>resolutions</code> if you know the exact width and height of the image. Check out the <a href="https://www.gatsbyjs.org/packages/gatsby-image/">gatsby-image docs</a> for a more detailed explanation on these image types.</p>

<p>Now our <code>one.jpg</code> should be ready to rock and roll. We can take a look at the data for this image by doing a <code>console.log(this.props.data)</code> inside the <code>render()</code> function, and you should see something like this:</p>

<p><a href="https://i.imgur.com/8bRktxJ.png">https://i.imgur.com/8bRktxJ.png</a></p>

<h3 class="mt-5 mb-3">Importing the gatsby-image component</h3>

<p>Going back up to the top of the page, let&rsquo;s import the <code>gatsby-image</code> component:</p>

<pre><code class="language-jsx">...
import Img from 'gatsby-image'

class BlogIndex extends React.Component {
...
</code></pre>

<p>And add the new component right below the existing <code>&lt;Bio /&gt;</code> component:</p>

<pre><code class="language-jsx">...
&lt;Bio /&gt;

&lt;Img sizes={this.props.data.imageOne.sizes} /&gt;

{posts.map(({ node }) =&gt; {
...
</code></pre>

<p>Your shiny new image should show up on the site now, with all optimizations in place! We can now add the other two images to our query, and add them to the page. Our full query now looks like:</p>

<pre><code class="language-javascript">export const pageQuery = graphql`
  query IndexQuery {
    site {
      siteMetadata {
        title
      }
    }
    allMarkdownRemark(sort: { fields: [frontmatter___date], order: DESC }) {
      edges {
        node {
          excerpt
          fields {
            slug
          }
          frontmatter {
            date(formatString: &quot;DD MMMM, YYYY&quot;)
            title
          }
        }
      }
    }
    imageOne: imageSharp(id: { regex: &quot;/one.jpg/&quot; }) {
      sizes(maxWidth: 630) {
        ...GatsbyImageSharpSizes
      }
    }
    imageTwo: imageSharp(id: { regex: &quot;/two.jpg/&quot; }) {
      sizes(maxWidth: 630) {
        ...GatsbyImageSharpSizes
      }
    }
    imageThree: imageSharp(id: { regex: &quot;/three.jpg/&quot; }) {
      sizes(maxWidth: 630) {
        ...GatsbyImageSharpSizes
      }
    }
  }
`
</code></pre>

<p>And up in our <code>render()</code> method:</p>

<pre><code class="language-jsx">return (
  &lt;div&gt;
    &lt;Helmet title={siteTitle} /&gt;
    &lt;Bio /&gt;

    &lt;Img sizes={this.props.data.imageOne.sizes} /&gt;

    {posts.map(({ node }) =&gt; {
      const title = get(node, 'frontmatter.title') || node.fields.slug
      return (
        &lt;div key={node.fields.slug}&gt;
          &lt;h3
            style={{
              marginBottom: rhythm(1 / 4),
            }}
          &gt;
            &lt;Link style={{ boxShadow: 'none' }} to={node.fields.slug}&gt;
              {title}
            &lt;/Link&gt;
          &lt;/h3&gt;
          &lt;small&gt;{node.frontmatter.date}&lt;/small&gt;
          &lt;p dangerouslySetInnerHTML={{ __html: node.excerpt }} /&gt;
        &lt;/div&gt;
      )
    })}

    &lt;Img sizes={this.props.data.imageTwo.sizes} /&gt;
    &lt;Img sizes={this.props.data.imageThree.sizes} /&gt;

  &lt;/div&gt;
)
</code></pre>

<p>If you reload the page, you should see an added &ldquo;blur up&rdquo; effect that comes built in with <code>gatsby-image</code> which loads a blurry placeholder image before the real one loads. Scroll down the page to see <code>imageTwo</code> and <code>imageThree</code> lazy load in!</p>

<h4><a href="http://hc-gatsby-image-demo.surge.sh/">Finished Product</a> <small>( <a href="https://github.com/ChangoMan/gatsby-image-demo">view source</a> )</small></h4>

    </div>
</main>



<amp-analytics type="googleanalytics">
    <script type="application/json">
        {
            "vars": {
                "account": "UA-115990515-1"
            },
            "triggers": {"trackEvent":{"on":"click","request":"event","selector":"body","vars":{"eventAction":"click","eventCategory":"body-click"}},"trackPageview":{"on":"visible","request":"pageview"}}
        }
    </script>
</amp-analytics>

</body>
</html>
